<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏—ë–º–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤</title>
  <link rel="manifest" href="app.webmanifest">
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 2rem;
      line-height: 1.5;
      background-color: #f9f9f9;
      color: #333;
    }
    h1 {
	line-height: 1.2;
    }
    fieldset {
      margin-bottom: 2rem;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      background-color: #fff;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      display: grid;
      gap: 0.5rem;
    }
    legend {
      font-weight: bold;
      font-size: 1.2rem;
      padding: 0 0.5rem;
      line-height: 1.2;
    }
    label {
      display: flex;
      align-items: baseline;
      gap: 0.5rem;
      cursor: pointer;
    }
    label:has(input:disabled) {
	color: hsl(0 0% 60%);
    }
    /* input[type="checkbox"] {
      transform: scale(1.2);
    } */
    }
  </style>
</head>
<body>
  <p id="exp-info"></p>

  <form id="med-form">
    <h2>–£—Ç—Ä–æ</h2>
    <fieldset>
      <legend>–ù–∞—Ç–æ—â–∞–∫</legend>
      <label><input type="checkbox" name="morning1">TUDCA/–£—Ä—Å–æ—Å–∞–Ω, 1 –∫–∞–ø</label>
      <label>
	<input type="checkbox" name="morning2">
	<span>–ù–æ—Ä–º–æ—Ñ–ª–æ—Ä–∏–Ω <b>–õ</b>/–ë (14 –¥–Ω–µ–π, 7 –¥–Ω–µ–π –ø–µ—Ä–µ—Ä—ã–≤, 14 –¥–Ω–µ–π), 15-20 –º–ª</span>
      </label>
    </fieldset>
    <fieldset>
      <legend>–ó–∞ —á–∞—Å –¥–æ –µ–¥—ã</legend>
      <label><input type="checkbox" name="morning3">–í–æ–±—ç–Ω–∑–∏–º, 2 —Ç–∞–±</label>
    </fieldset>
    <fieldset>
      <legend>–ó–∞ 30 –º–∏–Ω –¥–æ –µ–¥—ã</legend>
      <label><input type="checkbox" name="morning4">–ê—Ä—Ç–∏—à–æ–∫, 1 –∫–∞–ø</label>
      <label><input type="checkbox" name="morning5" disabled>–õ–µ–≤–∑–µ—è, 20 –∫–∞–ø–µ–ª—å (—Å 3 –Ω–µ–¥–µ–ª–∏)</label>
    </fieldset>
    <fieldset>
      <legend>–° –µ–¥–æ–π</legend>
      <label><input type="checkbox" name="morning6">–í–∏—Ç–∞–º–∏–Ω C, 1 –∫–∞–ø</label>
      <label><input type="checkbox" name="morning7">–í–∏—Ç–∞–º–∏–Ω D3, 1 –∫–∞–ø</label>
      <label><input type="checkbox" name="morning8" disabled>–†–æ–¥–∏–æ–ª–∞, 1 –∫–∞–ø (—Å 3 –Ω–µ–¥–µ–ª–∏)</label>
    </fieldset>
    <fieldset>
      <legend>–ß–µ—Ä–µ–∑ —á–∞—Å –ø–æ—Å–ª–µ –µ–¥—ã</legend>
      <label><input type="checkbox" name="morning9">–ú—É–ª—å—Ç–∏–≤–∏—Ç–∞–º–∏–Ω—ã Two-Per-Day, 1 —Ç–∞–±</label>
    </fieldset>

    <h2>–û–±–µ–¥</h2>
    <fieldset>
      <legend>–ó–∞ —á–∞—Å –¥–æ –µ–¥—ã</legend>
      <label><input type="checkbox" name="noon1">NAC, 1 –∫–∞–ø</label>
    </fieldset>
    <fieldset>
      <legend>–ó–∞ 30 –º–∏–Ω –¥–æ –µ–¥—ã</legend>
      <label><input type="checkbox" name="noon2">–ê—Ä—Ç–∏—à–æ–∫, 1 –∫–∞–ø</label>
      <label><input type="checkbox" name="noon3">–¢–∞—É—Ä–∏–Ω, 1 –∫–∞–ø</label>
      <label><input type="checkbox" name="noon4" disabled>–õ–µ–≤–∑–µ—è, 20 –∫–∞–ø–µ–ª—å (—Å 3 –Ω–µ–¥–µ–ª–∏)</label>
    </fieldset>
    <fieldset>
      <legend>–° –µ–¥–æ–π</legend>
      <label><input type="checkbox" name="noon5">–ú–∞–≥–Ω–∏–π, 2 —Ç–∞–±</label>
      <label><input type="checkbox" name="noon6">–í–∏—Ç–∞–º–∏–Ω C, 1 –∫–∞–ø</label>
      <label><input type="checkbox" name="noon7" disabled>–†–æ–¥–∏–æ–ª–∞, 1 –∫–∞–ø (—Å 3 –Ω–µ–¥–µ–ª–∏)</label>
    </fieldset>
    <fieldset>
      <legend>–ß–µ—Ä–µ–∑ —á–∞—Å –ø–æ—Å–ª–µ –µ–¥—ã</legend>
      <label><input type="checkbox" name="noon8">–ú—É–ª—å—Ç–∏–≤–∏—Ç–∞–º–∏–Ω—ã Two-Per-Day, 1 —Ç–∞–±</label>
    </fieldset>
    <fieldset>
      <legend>–ú–µ–∂–¥—É –æ–±–µ–¥–æ–º –∏ —É–∂–∏–Ω–æ–º</legend>
      <label><input type="checkbox" name="noon9">–í–æ–±—ç–Ω–∑–∏–º, 1-2 —Ç–∞–± –Ω–∞ –ø—É—Å—Ç–æ–π –∂–µ–ª—É–¥–æ–∫ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è (—Å–æ 2 –Ω–µ–¥–µ–ª–∏)</label>
      <label><input type="checkbox" name="noon10">–•–∏—Ç–æ–∑–∞–Ω, 2 –∫–∞–ø</label>
    </fieldset>

    <h2>–í–µ—á–µ—Ä</h2>
    <fieldset>
      <legend>–ó–∞ —á–∞—Å –¥–æ –µ–¥—ã</legend>
      <label><input type="checkbox" name="evening1">NAC, 1 –∫–∞–ø –¥–æ —É–∂–∏–Ω–∞</label>
      <label><input type="checkbox" name="evening2">TUDCA/–£—Ä—Å–æ—Å–∞–Ω, 1 –∫–∞–ø</label>
    </fieldset>
    <fieldset>
      <legend>–ó–∞ 30 –º–∏–Ω –¥–æ –µ–¥—ã</legend>
      <label><input type="checkbox" name="evening3">–ê—Ä—Ç–∏—à–æ–∫, 1 –∫–∞–ø</label>
      <label><input type="checkbox" name="evening4">–¢–∞—É—Ä–∏–Ω, 1 –∫–∞–ø</label>
    </fieldset>
    <fieldset>
      <legend>–° –µ–¥–æ–π</legend>
        <label><input type="checkbox" name="evening5">–ú–∞–≥–Ω–∏–π, 2 —Ç–∞–±</label>
        <label><input type="checkbox" name="evening6">–í–∏—Ç–∞–º–∏–Ω C, 1 –∫–∞–ø</label>
    </fieldset>
    <fieldset>
      <legend>–ß–µ—Ä–µ–∑ —á–∞—Å –ø–æ—Å–ª–µ –µ–¥—ã</legend>
      <label><input type="checkbox" name="evening7">–¢—Ä–∏—Ñ–∞–ª–∞, 1-2 —Ç–∞–±</label>
    </fieldset>
    <fieldset>
      <legend>–ù–∞ –Ω–æ—á—å</legend>
      <label>
	<input type="checkbox" name="evening8">
	<span>–ù–æ—Ä–º–æ—Ñ–ª–æ—Ä–∏–Ω <b>–õ</b>/–ë (14 –¥–Ω–µ–π, 7 –¥–Ω–µ–π –ø–µ—Ä–µ—Ä—ã–≤, 14 –¥–Ω–µ–π), 15-20 –º–ª</span>
      </label>
        <label><input type="checkbox" name="evening9">–•–∏—Ç–æ–∑–∞–Ω, 2 –∫–∞–ø</label>
    </fieldset>
  </form>
  <script>
    const form = document.getElementById('med-form');
    const storageKey = 'medicationSchedule';
    const startDate = '2025-09-02';
    const expInfoEl = document.getElementById('exp-info');

    // –ü–æ–ª—É—á–∏—Ç—å YYYY-MM-DD
    function getToday() {
	const today = new Date();
	const year = today.getFullYear();
	const month = String(today.getMonth() + 1).padStart(2, '0');
	const day = String(today.getDate()).padStart(2, '0');
	return `${year}-${month}-${day}`;
    }

    // –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø—Ä–æ—à–ª–æ —Å –Ω–∞—á–∞–ª–∞ –∫—É—Ä—Å–∞
    function daysBetween(start, end) {
      const msPerDay = 1000 * 60 * 60 * 24;
      const startDate = new Date(start);
      const endDate = new Date(end);
      return Math.floor((endDate - startDate) / msPerDay) + 1;
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ-–±–ª–æ–∫
    function updateExpInfo(saved) {
        const days = daysBetween(startDate, getToday());
        expInfoEl.textContent = `üìÖ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∏–¥–µ—Ç ${days}-–π –¥–µ–Ω—å (–Ω–∞—á–∞–ª–∏ 2 —Å–µ–Ω—Ç—è–±—Ä—è).`;
    }

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ–∫–±–æ–∫—Å–æ–≤
    window.addEventListener('DOMContentLoaded', () => {
	const saved = JSON.parse(localStorage.getItem(storageKey) || '{}');
	if (saved.date === getToday()) {
            for (const [name, checked] of Object.entries(saved.state || {})) {
		const checkbox = form.elements[name];
		if (checkbox) checkbox.checked = checked;
	    }
	} else {
	    localStorage.removeItem(storageKey);
	}
	updateExpInfo();
    });

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    form.addEventListener('change', () => {
      const state = {};
      for (const el of form.elements) {
        if (el.type === 'checkbox') {
          state[el.name] = el.checked;
        }
      }
      localStorage.setItem(storageKey, JSON.stringify({
        date: getToday(),
        state,
      }));
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Ñ–æ—Ä–º—ã
    function resetForm() {
      // –û—á–∏—Å—Ç–∏–º –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã
      for (const el of form.elements) {
        if (el.type === 'checkbox') {
          el.checked = false;
        }
      }
      localStorage.removeItem(storageKey); // –û—á–∏—Å—Ç–∏–º localStorage
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ–≤—ã–π –¥–µ–Ω—å –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
    setInterval(() => {
      if (getToday() !== JSON.parse(localStorage.getItem(storageKey) || '{}').date) {
          resetForm();
	  updateExpInfo();
      }
    }, 60000); // 60000 –º—Å = 1 –º–∏–Ω—É—Ç–∞
  </script>
</body>
</html>
